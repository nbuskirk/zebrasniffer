$(function(){function e(){$("#home").attr("href","http://"+p.mylocation+":7990"),$("#home > button").prop("disabled",!1)}function o(){var e="http://"+p.mylocation+":7996?cmd=getRecordingState";$.getJSON(e,function(e){switch(e.RecordingState){case 0:c();break;case 1:i()}t()})}function t(){var e="http://"+p.mylocation+":7996?cmd=getNumRecordedItems";$.getJSON(e,function(e){chrome.browserAction.setBadgeText({text:e.NumRecordedItems.toString()})})}function n(){var e={mode:"fixed_servers",rules:{singleProxy:{host:p.mylocation,port:7997},bypassList:["127.0.0.1",p.mylocation]}};chrome.proxy.settings.set({value:e,scope:"regular"},function(){})}function r(){chrome.proxy.settings.clear({scope:"regular"})}function c(){$("#play").prop("disabled",!1),$("#pause").prop("disabled",!0),$("#reset").prop("disabled",!1),$("#pagebreak").prop("disabled",!1),chrome.browserAction.setBadgeBackgroundColor({color:"#FF0000"})}function i(){$("#play").prop("disabled",!0),$("#pause").prop("disabled",!1),$("#pagebreak").prop("disabled",!1),chrome.browserAction.setBadgeBackgroundColor({color:"#00FF00"})}function a(e){var o="Demo Pagebreak",t="http://"+p.mylocation+":7996?cmd=insertPagebreak&comment="+o;$.getJSON(t.toString(),function(){u("Pagebreak Inserted","Page break has been inserted.")})}function s(){var e="http://"+p.mylocation+":7996?cmd=startRecording";$.getJSON(e.toString(),function(){n(),o(),u("Recording Started","ZebraSniffer is recording on: "+p.mylocation+"Your Proxy is also set. Begin Browsing!")})}function d(){var e="http://"+p.mylocation+":7996?cmd=stopRecording";$.getJSON(e.toString(),function(){r(),o(),u("Recording Paused.","ZebraSniffer has paused recording.\nProxy Disabled.")})}function l(e){var t="http://"+p.mylocation+":7996?cmd=clearRecording";$.getJSON(t.toString(),function(){o(),1==e?u("Recording Cleared","Your recording has been reset. Your cache has been cleared and cookies emptied."):0==e&&u("Recording Cleared","Your recording has been reset. Cache kept intact."),$(".modal").modal("hide")})}function u(e,o){chrome.notifications.create("",{type:"basic",title:e,message:o,iconUrl:chrome.extension.getURL("icon.png")})}function m(){$(".modal").modal("show"),l(!1)}function g(){$(".modal").modal("show");var e=0;chrome.browsingData.remove({since:e},{appcache:!0,cache:!0,cookies:!0,downloads:!0,fileSystems:!0,formData:!0,history:!0,indexedDB:!0,localStorage:!0,serverBoundCertificates:!0,pluginData:!0,passwords:!0,webSQL:!0},l(!0))}var p={};$("body").on("click","a",function(){return chrome.tabs.create({url:$(this).attr("href")}),!1}),chrome.storage.sync.get({mylocation:null},function(t){void 0===t.mylocation||""==t.mylocation||null==t.mylocation?console.log("No options set, disabling action buttons."):(p.mylocation=t.mylocation,e()),o()}),$("#setup").click(function(){chrome.runtime.openOptionsPage?chrome.runtime.openOptionsPage():window.open(chrome.runtime.getURL("options.html"))}),$("#pagebreak").click(function(){a()}),$("#play").click(function(){s()}),$("#pause").click(function(){d()}),$("#reset").contextmenu(function(){return m(),!1}),$("#reset").mousedown(function(e){switch(e.which){case 1:g();break;case 2:m()}return!1})});